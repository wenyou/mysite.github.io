---
layout: post  
title: "威利在线基金交易系统正在开发中"  
description: "威利在线基金交易系统正在开发中"  
category: 工作
tags: [文档]  
---
###威利在线基金交易系统正在开发中###
__领域分析__

**目录**

1. 引言 2
2. 术语表 2 
	* 2.1. 主要术语 2
	* 2.2. 投资方案相关: 2
	* 2.3. 帐户结算: 3
3. 领域基本知识 3
	* 3.1. 领域概述 3
	* 3.1.1. 服务介绍 3
	* 3.2. 投资方案 4
	* 3.2.1. 概述 4
	* 3.2.2. 投资方案属性 4
	* 3.3. 理财帐户介绍 7
	* 3.3.1. 帐户概述 7
	* 3.3.2. 奖金帐户 7
	* 3.3.3. 帐户登陆 8
	* 3.3.4. 帐户安全保护措施 8
	* 3.4. 理财帐户管理 8
	* 3.4.1. 帐户认证 8
	* 3.5. 支付结算 8
	* 3.5.1. 支付结算概述 8
	* 3.5.2. 支付选项 8
	* 3.5.3. 支付选项属性 9
	* 3.5.4. 支付结算流程 11
	* 3.5.5. 子支付记录处理 12
	* 3.5.6. 支付处理页 14
	* 3.5.7. 支付结果页 14
	* 3.5.8. 支付状态通知脚本 14
	* 3.6. 子帐户 14
	* 3.6.1. 子帐户概述 14
	* 3.6.2. 子帐户注资流程 14
	* 3.6.3. 注资结算流程 14
	* 3.6.4. 注资表单处理 15
4. 用户 15
5. 环境 15
6. 当前执行的任务和规程 15

__附录I-数据表单 16__

	 1. 理财帐户申请表单 16
	 2. 投资表单 17
	 3. 支付表单 19
	 4. 注资表单 23
	 5. 子帐户收支表单 25
	 6. 帐户升级表单 25

__1. 引言__
<p>领域为”外汇托管帐户投资理财”,开发一个系统为了帮助广大投资者通过本系统轻松实现投资理财的目的.本系统会准确无误的报告客户的投资信息,客户并且能够轻松的查询以往的投资记录,客户投资的收益以及本金可通过本系统的支付网关进行存款和取款操作,为客户提供了完全自助的投资理财服务.
同时本系统也方便我们公司对理财服务的相关业绩的信息统计.</p>
__2. 术语表__
<p>2.1. 主要术语:</p>
<p>2.1.1. 外汇托管帐户(理财帐户)</p>
<p>外汇托管帐户是由经纪公司发起并提供一系列咨询服务,通常由经纪公司经验丰富和专业的外汇投资专家(以下简称 [经理人])进行管理的一种独立投资帐户.外汇管理账户是一种简单的委托理财方式,通过外汇管理帐户,投资者无需亲手实际操作，即可享受高额的外汇交易回报，而经纪公司只需收取小部分佣金。</p>

<p>2.1.2. 投资限额</p>
<p>每位客户最多能够委托给我们帮助其投资理财的总金额.</p>

<p>2.1.3. 投资交易</p>
<p>即客户将资金委托给我们,我们将资金投资于外汇市场并从中获得收益,以帮助客户实现理财计划.</p>

<p>我们会要求客户填写[投资表单]以对每笔[投资交易]都进行记录,以方便我们日后于客户进行结算,也是我们之间的依据.</p>

<p>2.1.4. 投资本金</p>
<p>即客户每次进行投资交易时委托给我们的资金的总金额.</p>

<p>2.2. 投资方案相关:</p>
<p><p>2.2.1. 披露投资业绩</p>
即我们公司的网站管理员或系统,将某[投资方案]的[投资业绩]公布到网站的[投资方案]的[业绩表现]页面内.[披露投资业绩]的同时,也会进行[投资业绩结算].</p>

<p>2.2.2. 周期性披露</p>
<p>自[投资方案][开放日期]后,会在其[投资方案有效期]内,每隔一个[投资业绩披露周期]就会[披露投资业绩]</p>

<p>例子:</p>
<p>投资方案A的[投资业绩披露周期]为1天,那么该方案的投资业绩会每天进行披露.</p>
<p>如2009-05-06投资方案A的投资业绩为0.1%,2009-05-07投资方案A的投资业绩为0.15%,</p>

<p>2.2.3. 投资业绩</p>
<p>[投资方案]在其[投资方案有效期]内,经过一个[投资周期]后从外汇市场中所获得的[投资回报率].</p>

<p>例子:投资方案A在2009-05-06的投资业绩为0.5%.</p>

<p>2.2.4. 投资方案有效期</p>
<p>即当前日期小于[投资方案]的[关闭日期],这期间我们称该[投资方案]在其[投资方案有效期]内
[投资方案有效期]已过,那么我们会将所有投资该[投资方案]的客户的[投资本金]退还到他们的理财帐户内对应的[子帐户余额]内.每个投资方案都存在本金锁定时间,即投资该方案后要多少天以后才能取回本金.</p>

<p>2.3. 帐户结算:</p>
<p>2.3.1. 结算方式</p>
<p>结算方式是客户在对[支付表单]的[子支付记录]进行[支付结算]时的一种处理方式分类.</p>

<p>2.3.2. 支付网关</p>
<p>关于[支付网关]的介绍请参考这里</p>

<p>[支付网关]一般分为[第三方支付]和[电子钱包]两种[支付网关]类型.</p>
<p>[第三方支付]是一种即时支付型的结算方式,该[支付网关]的[支付接口]一般要求消费者客户输入银行帐户信息,消费者客户提交以后[支付网关]会立即从其输入的银行帐户里扣除相应的结算金额,然后[支付网关]再结算给该笔支付收款方的[商业帐户].</p>
<p>一般情况下消费者无需到[支付网关]的官方网站上开设[消费帐户].如果[支付网关]要求开设[消费帐户],帐户与帐户之间是不能转帐的.</p>

<p>[电子钱包]是一种预付型的结算方式,消费者客户必须要先到[支付网关]的官方网站上开设[消费帐户],然后客户通过[支付网关]提供的付款方式对[消费帐户]冲值.</p>
<p>帐户冲值以后就[消费帐户]就可以到[商业帐户]的官方网站上进行消费,该[支付网关]的[支付接口]一般只需要客户提供[消费帐户]的[帐户号码]就可以了,然后[支付网关]会自动扣除[消费帐户]余额对应的结算金额,并且将其打入到[商业帐户]的余额内.</p>
<p>一般情况下帐户可以随时与帐户之间进行转帐操作,[消费帐户]可以随时转帐给[商业帐户],[商业帐户]也可以随时转帐给[消费帐户].</p>

<p>3. 领域基本知识</p>
<p>3.1. 领域概述</p>
<p>3.1.1. 服务介绍</p>
<p>我们公司主要提供外汇投资理财服务,客户只需要在我公司开设一个外汇托管帐户(以下简称理财帐户),即可享受我们的服务,本系统的官方语言是英语,当然用户可以很轻松的点击相关按钮切换为其他语言.服务流程按照如下步骤进行:</p>
<p>1. 首先客户需要填写[理财帐户申请表单]来申请一个[理财帐户],表单填写完成并提交以后,系统会自动为每位客户分配一个{最小6位数}的唯一和随机的[数字帐号].接着系统会自动发送一封名为[帐户开启通知函]的电子邮件到[帐户申请表单]所填写的电子邮箱里,客户可以通过查阅邮件内容获取[数字帐号];并且必须点击邮件内的[理财帐户激活连接][激活理财帐户],否者客户无法登陆进入理财帐户.</p>
<p>2. 理财帐户激活以后,客户就可以登陆理财帐户进行[投资交易].</p>
<p>3. 首先客户完成填写[投资表单].</p>
<p>4. [投资表单]填完以后,需要填写[支付表单]</p>
<p>5. [投资表单]的[处理状态]为[付款完成](也称之为[等待生效])以后,我们会将该笔[投资交易]的[投资本金]分配给我们公司专业的外汇[经理人],让他们投资外汇市场,并且我们会在[投资方案有效期]内[周期性披露]各[投资方案]的[投资业绩].</p>
<p>6. [披露投资业绩]时,我们会进行[投资业绩结算].</p>

<p>异常:</p>
<p>1. 客户可以在7天内申请[投资交易退款]</p>
<p>2. [支付结算]未完成</p>
<p>备选路径:</p>
<p>1. 客户可以对[投资方案]进行[复利设置]</p>
<p>2. 客户可以取出[正常生效]的[投资记录]的[投资本金]</p>
<p>3. 客户可以取出[正常生效]的[投资记录]的[复投资金]</p>

<p>网站前台的语言包与客户后台的语言包分离,互不相关.</p>
<p>因为很有可能出现以下情况:</p>
<p>网站前台提供了法语支持,客户切换到了法语.当他登陆[理财帐户]的时候,而帐户管理平台没有法语支持.</p>

<p>3.2. 投资方案</p>
<p>3.2.1. 概述</p>
<p>[投资方案]是我们公司的[经理人]通过在外汇市场长期的交易经验,根据当前市场环境和资本因素等客观因素而制定的一系列投资策略,以达到能够从外汇市场获得丰厚的收益.由于各方案的[经理人],市场因素和资本因素等各种客观因素的影响程度不同,所以各[投资方案]的[投资收益]和[风险程度]也有所不同.</p>

<p>通常情况下我们公司对客户开放了多个[投资方案],客户可以根据自身的风险承受能力以及经济能力,选择适合自己的[投资方案]和合适的金额进行投资;当然客户也可以将资金分散到各[投资方案],以达到分散风险,利润最大化的[组合投资]目的.每个[投资方案]由于上述因素影响程度不同,它们也各自拥有各种不同的属性,每种属性取值不同可能也会影响到客户的[投资收益].</p>

<p>我们可以随时添加和删除一个[投资方案],只要将每个[投资方案]的属性设置完成就可以了.
同时我们也可以随时修改[投资方案]的属性.</p>

<p>3.2.2. 投资方案属性</p>
投资方案的每个属性会影响到客户[投资交易]和[投资业绩结算]
网站正式上线后,我们会开放两个[投资方案],请查看<投资方案实例.xls>文件以了解各[投资方案]的相关属性.</p>
<p>属性名称 描述 取值</p>
<p>投资方案名称 该名称只是对投资方案的一个标示和辨别 字符串</p>
<p>投资方案简称 作用同上,只不过表现形式为英文大写字母缩写 字符串</p>
<p>投资方案编号 作用同上,只不过该值是数字形式 4位整数</p>
<p>首次最低投资额度 客户 [投资交易]时,所选择的[投资方案]如果是第一次投资,那么[投资表单]的[投资金额]必须大于或等于该值,否者我们不受理该笔[投资交易]. 浮点数</p>
<p>再次最低投资额度 客户 [投资交易]时,所选择的[投资方案]如果是第二次或者二次以上投资,那么[投资表单]的[投资金额]必须大于或等于该值,否者我们不受理该笔[投资交易]. 浮点数</p>
<p>最大投资额度 客户在本[投资方案]的最大投资金额:如果客户在本[投资方案]的已投资金额已经超过该值,那么客户[投资交易]时不能再选择该[投资方案] 浮点数</p>
<p>投资业绩披露周期</p>
<p>(投资周期)</p>
<p><p>(投资收益结算周期) 本[投资方案]每次[披露投资业绩]的时间间隔;也可以说我们每次与投资本[投资方案]客户结算[投资收益]的时间间隔.</p>
本属性的单位可为{天|周|月|年}</p>
<p>本属性的值为{>=1}</p>

<p>例子:</p>
<p>1. 如投资方案A的[投资业绩披露周期]为1天,那么表示该方案每天都会[披露投资业绩];</p>
<p>2. 如投资方案A的[投资业绩披露周期]为5天,那么表示该方案每隔5天都会[披露投资业绩];</p>
<p>3. 如投资方案A的[投资业绩披露周期]为3月,那么表示该方案每隔3月都会[披露投资业绩].…</p>

<p>本属性需要设置两个值:</p>
<p> 单位</p>
<p>天,周,月,年</p>
<p> 间隔</p>
<p>正整数</p>
<p>投资方案类型 我们的投资方案分为了两种类型:</p>
<p> 进取型方案(有险方案)</p>
<p>客户投资该类型的[投资方案],[投资本金]可能会出现亏损.即本[投资方案]每次在[披露投资业绩]时,其[投资业绩]可能呈负数,表示本[投资方案]在本[投资周期]内的投资失败而造成了客户的[投资本金]的亏损,那么凡是[投资表单]内选择本[投资方案]的[投资记录]的[投资本金]
应该减去相应百分比的亏损金额.</p>
<p>参考下方的[投资方案投资回报率]获取更详细的信息</p>

<p> 稳健增值方案(无险方案)</p>
<p>客户投资该类型[投资方案]的[投资记录]可以周期性的固定[投资回报率]的[投资收益],[投资本金]绝对不会亏损,本[投资方案]每次在[投资业绩结算]时,客户可以获得固定[投资回报率]的[投资收益],其[投资回报率]的数值由本方案的[投资方案投资回报率]设定,本[投资方案]有点类似银行存款,我们周期性的支付客户固定利率的利息.</p>
<p>枚举:</p>
<p>1. 有险2. 无险</p>
<p>投资方案投资回报率</p>
<p>(投资收益率) 本属性的值设定根据本[投资方案]的[投资方案类型]有所不同,
 进取型方案(有险方案)</p>
<p>如果本[投资方案]为该类型,那么该属性会分为2个子属性[最小投资回报率]和[最大投资回报率],这两个属性组成一个区间{A,B},其中A代表[最小投资回报率],B代表[最大投资回报率],该区间是对本[投资方案]的[投资业绩]进行一个限定.</p>
<p>本[投资方案]每次[披露投资业绩]时,其[投资业绩]必须大于或等于[最小投资回报率],并且必须小于或等于[最大投资回报率].</p>
<p>如果[最小投资回报率]的取值为负数,那么表示本[投资方案][投资业绩]的最大亏损多少百分比,[最小投资回报率]本[投资方案]的[风险程度]表现形式.即本[投资方案][披露投资业绩]时,客户投资本[投资方案]的[投资记录]的[投资本金]在该[投资周期]内最大会亏损(减少)多少百分比.</p>

例子:
1. 投资方案A的[投资方案]类型为[进取型方案],它的[最小投资回报率]为2%, [最大投资回报率]为8%, [投资业绩披露周期]为1月.
那么表示该[投资方案]每次[披露投资业绩]时,其[投资业绩]的范围在2%-8%左右.
比如客户Z在5月投资了1000$在投资方案A,该[投资方案]属于[进取型方案]类型, [最小投资回报率] 为2%, [最大投资回报率] 为8%,[投资业绩披露周期]为1月.该[投资方案]在6月1日[披露投资业绩],其[投资业绩]为7%,7%再减去表现费就是客户的[实际投资收益].
2. 投资方案A的[投资方案]类型为[进取型方案],它的[最小投资回报率]为-5%, [最大投资回报率]为8%,[投资业绩披露周期]为1月.
那么表示该[投资方案]每次[披露投资业绩]时,[投资业绩]最大可能会亏损5%也可能最多能够赢利8%.
比如客户Z在5月投资了1000$在投资方案A,该[投资方案]属于[进取型方案]类型, [最小投资回报率] 为-5, [最大投资回报率] 为8,[投资业绩披露周期]为1月.该[投资方案]在6月1日[披露投资业绩],其[投资业绩]为-4%,那么表示该[投资周期][投资本金]出现亏损,所有投资该[投资方案]的[投资记录]的[投资本金]相对上一投资周期,只占其96%了.
[投资业绩结算] 后, 那么客户Z 5月1000$的[投资本金]就只变为960$的[投资本金]了.
(注意:上面的结果没有扣除我们承担的风险).
————————————————————————————————————————————————————–
 稳健增值方案(无险方案-Risk-free)
如果本[投资方案]为该类型,那么该属性只需要设置一个值,该值称为[固定收益率],即是[投资方案类型]里所说到的客户可以周期性获得的那个固定[投资回报率].

例子:
1. 投资方案A的[投资方案]类型为[稳健增值方案],它的[固定收益率]为0.1%, [投资业绩披露周期]为1天.
客户A在5月1日投资了1000$在该[投资方案],以后的每天客户A均能获得1$的[投资收益] (没有扣除表现费),直到该[投资方案]到了[关闭日期]或者客户[取回本金].
2. 投资方案A的[投资方案]类型为[稳健增值方案],它的[固定收益率]为10%, [投资业绩披露周期]为3月.
客户A在5月1日投资了1000$在该[投资方案],以后的每隔3个月客户A均能获得100$的[投资收益] (没有扣除表现费),直到该[投资方案]到了[关闭日期]或者客户[取回本金].

投资业绩清单 对有险方案投资业绩公布的清单,或者存在单独的功能来公布投资业绩.
表现费 表现费是我们帮助客户理财,为客户带来[投资收益]所获得的佣金,通常佣金为[投资收益]一定比例.当然为客户带来了[投资收益]我们会抽取佣金,当我们投资失败时,让客户的[投资本金]损失我们也应该承担一定比例的风险,这样才对客户公平,我们收取了多少比例的[表现费],那么就应该承担多少风险.
该值取值{100>X=0}的正整数,如果该值设置为0,那么表示本投资方案没有表现费

例子:
1. 投资方案A的[投资方案]类型为[进取型方案],它的[最小投资回报率]为-5%, [最大投资回报率]为8%,[投资业绩披露周期]为1月,[表现费]为20%.
客户A在5月1日投资了1000$在该[投资方案],6月1日该[投资方案][披露投资业绩]时的[投资业绩]为5%,理论上客户的[投资收益]为50$,但是由于我们要抽取[投资收益]20%的[表现费]佣金,即[投资收益]的1%,那么客户的[实际投资收益]为40$,[实际投资回报率]为4%.

6月1日该[投资方案][披露投资业绩]时的[投资业绩]为-5%,理论上客户[投资本金]亏损50$,但是由于我们收取了20%的[表现费],那么我们就需要承担20%的亏损风险,客户的[实际亏损]仅为40$,我们承担了10$的亏损,即占亏损比例的1%.
2. 投资方案A的[投资方案]类型为[稳健增值方案],它的[固定收益率]为0.1%, [投资业绩披露周期]为1天,[表现费]为20%.
客户A在5月1日投资了1000$在该[投资方案],理论上以后的每天客户A均能获得1$的[投资收益],但是扣除[表现费]以后客户获得的[实际投资收益]为0.8$每天,直到该[投资方案]到了[关闭日期]或者客户[取回本金].
由于[稳健增值方案]不会出现本金亏损,所以这个方案也无需承担亏损风险. 大于或等于0,但是必须小于100的正整数.
本金锁定时间 正常情况下客户可以随时取回[投资交易]的[投资本金],因为考虑到上诉因素实际上并不能将客户的所有[投资本金]投入到外汇市场,因为我们要闲置部分资金以让客户能够随时取回[投资本金],这样对并不能使[投资方案]的[投资收益]最大化.
为了能够使客户的[投资收益]最大化,我们对客户投资的某些[投资方案]的[投资本金]进行锁定,意思是客户不能够随时取回[投资本金],这样我们对[投资本金]的支配能力更强,所获得的[投资收益]也会更理想.

该属性的值就是客户投资本[投资方案]所要锁定的时间,以{天}为单位,值为一个{>=0}的正整数.该属性所表示自 [投资交易生效]后,客户要多少天以后才能取回该笔[投资交易]的[投资本金].如果该属性的值为0,那么表示客户[投资交易生效]后,随时可以取回该笔[投资交易]的[投资本金] >=0的正整数
周末是否交易 如果该值设置为否,当[投资业绩披露周期]为1天时,表示周末没有在外汇市场进行交易(自然没有赢利和亏损),所以周6和周日这两天不会进行[投资业绩结算];如果设置为是,那么周末正常进行[投资业绩结算]. 枚举:
是|否
节假日清单 当[投资业绩披露周期]为1天时,因为节假日我们的员工都要放假,没有在外汇市场进行交易(自然没有赢利和亏损),当当前日期在本清单出现以后,那么当日不进行[投资业绩结算]. 集合
发布日期 我们公司正式提案本[投资方案],并且将它公布到网站上的日期,但是这时客户并不能投资本[投资方案]. 日期
开放日期 客户能够正式投资本[投资方案]的日期,如果当前日期还没有到[开放日期],客户在投资表单里是不能选择的. 日期
关闭日期 本投资方案取消的日期,到了该日期以后客户不能再投资本[投资方案],并且会将客户之前投资本[投资方案]的[投资本金]原数退还给客户,退还不收取任何费用.如果此值设置为-1,那么表示本[投资方案]永远不过期. 日期或-1
风险程度 本[投资方案]的一个风险建议值, 枚举:
高|中|低
投资收益简述 0.1% daily(0.1%每天的利率) 字符串
简述 简短叙述 字符串
概述 详细叙述 字符串

3.3. 理财帐户介绍
3.3.1. 帐户概述
每个理财帐户会负责对客户与我们公司发生的[投资交易]的记录和汇总,同时也是客户与我们公司进行相关结算的载体.

客户登陆理财帐户以后理财帐户通过进行[投资交易]以获得收益,收益会经过我们的结算系统自动结算到客户的理财帐户内.客户可以随时查看[帐户余额],[帐户汇总], [投资组合]和[交易历史],并且修改[帐户资料].通常我们每月会发送一封电子对帐单到客户的电子邮箱内,电子对帐单的内容是对客户[理财帐户]当月的汇总.
3.3.2. 奖金帐户
概述:
为了降低各位客户的投资门槛,每为客户开设[理财帐户]后,均可获得100$的[开户奖金],而这个奖金会打入其[理财帐户]内[奖金帐户],客户在[投资交易]时可以使用[奖金帐户余额]进行[支付结算].
[白银理财帐户]和[黄金理财帐户]在[投资交易]时,分别可以获得[投资交易]的[投资金额]2.5%和5.0%的[投资奖金],这笔[投资奖金]会打入到客户[理财帐户]的[奖金帐户]内.

取回本金时,将各[子支付记录]的[支付金额]做为本金退还到客户帐户内,但是奖金帐户支付的不会退还.

限制:
 [奖金帐户余额]不能直接取款提现
[奖金帐户]的余额不能进行取款操作,因为它不是一个真正的[子帐户].
 [奖金帐户余额]进行[投资交易],其支付的[投资本金]可能会在年末作废
客户使用[奖金帐户余额]进行[支付结算]的[投资交易]的[子支付记录],它的[处理状态]可能会在年末自动更改为[已过期],[处理状态]为[已过期]的[子支付记录]是不能获得[投资收益]的.
 [奖金帐户余额]进行[投资交易],其[投资本金]不能取出.
 [奖金帐户余额]进行[投资交易],上线不能获得[投资交易提成]和[表现提成]
客户使用[奖金帐户余额]进行[支付结算]的[投资交易]的[子支付记录],其上线不能获得该笔[子支付记录]的[投资交易提成]和[表现费提成].
如:客户的[奖金帐户余额]有100$,AlertPay[子帐户]有20$.
客户[投资交易]时,使用AlertPay[子帐户]支付20$,[奖金帐户余额]支付100$进行[支付结算].
该客户的各上线,可以获得该客户使用AlertPay支付20$的[投资交易提成]和日后的[表现提成];但是不能获得100$支付的[投资交易提成]和日后的[表现提成].
 [奖金帐户余额]不能进行[帐户升级]
客户的[理财帐户]进行[帐户升级]时,不能使用[奖金帐户余额]进行[支付结算].

投资交易退款后,奖金帐户支付的金额也会自动返回到奖金帐户内.

为了记录下客户[理财帐户][奖金帐户余额]的每笔资金的收入和支出情况,系统在更改客户其[奖金帐户余额]之前,会提交一张[奖金帐户收支表单]以进行记录,提交以后系统会自动根据[奖金帐户收支表单]的信息更新[奖金帐户余额].
3.3.3. 帐户登陆
客户只需要输入帐户号码和帐户密码即可登陆进入理财帐户.
3.3.4. 帐户安全保护措施
PIN码保护(PIN: Personal Identity Number)
帐户每次进行如下操作时就需要[输入帐户PIN码]进行身份认证,因为只有客户自己才知道这个帐户[PIN码],这样才能保护帐户的资金安全.
 [帐户取款]
 [个人信息]设置
 [支付帐户]设置
 [帐户密码]设置

3.4. 理财帐户管理
3.4.1. 帐户认证
每个国家都存在相关的〈反洗黑钱法律〉,根据相关法律规定,从事金融服务行业的企业或机构必须遵守”了解你的客户”原则.因为我们公司要对每位客户的身份进行证实(以下简称[帐户认证]),客户必须上传身份证明和地址来证实客户的身份信息完全符合[理财帐户申请表单]内的身份信息.如果客户不进行帐户认证,客户不能通过某些[支付选项]进行取款或者存款,或者存在相关的限制.

[帐户升级表单正式生效]后,生效前赚取的佣金会结算到相应的帐户内.
问题:手动确认的佣金怎么处理?
3.5. 支付结算
3.5.1. 支付结算概述
[支付结算]即客户将[支付表单]里其中一笔[子支付记录]的[结算金额]相等的资金,通过客户选择的[结算方式]和[支付选项]将其支付给我们公司,我们收到资金以后该笔[子支付记录]的[支付状态]会立即更改为[付款完成].
3.5.2. 支付选项
客户将对应资金资金支付给我们的一种[付款结算方式],客户可以通过[支付中介机构]付款给我们,也可以直接现金付款给我们.我们根据每种[支付选项]的处理特征分为两种[支付选项结算类型]:
1. [在线支付]
这种[支付选项结算类型]的[支付选项]是一种[支付网关],这种[支付选项]一般是自助的[付款结算]方式,客户只需在该[支付选项]提供[支付接口页]提交相关的帐户信息,我们就会收到客户的付款,并且我们的系统会自动获取客户付款时的相关信息.
如:Paypal,AlertPay这些[支付选项]都属于[在线支付结算类型].

此类型我们简称为[在线支付结算类型]
2. [离线支付]
这种[支付选项结算类型]的[支付选项]是一种需要人工处理的[付款结算]处理方式,客户完成每笔[子支付记录]的[支付结算]以后.我们的网站管理员需要人工确认客户每笔[子支付记录]在[支付结算]时所支付的[付款金额],管理员需要手动更新[支付表单]的[已付款金额]和[处理状态].
如:Bank Wire,邮政汇款这些[支付选项]都属于[离线支付结算类型].

此类型我们简称为[离线支付结算类型]
3.5.3. 支付选项属性
[支付选项]拥有多个属性,并且每个[支付选项]各自的属性取值有所不同.
它们在填写[支付表单],[支付结算],[支付处理页],[支付状态更新脚本]和[子帐户注资]时会有不同的影响.
本[子帐户]取款时,取款的[支付选项]是否必须要填写了取款信息才能进行取款.

属性名称 属性描述 取值备注
[支付选项]设置
支付选项名称 字符串
支付选项结算类型 在线支付 | 离线支付 枚举
支付处理页地址 客户在[支付结算]时,点击[支付]按钮后,本[支付选项]要进入的页面地址 字符串
管理员取款处理页地址 稍后讲解 字符串
支付手续费 [支付结算]和[注资结算]时,本[支付选项]支付时要收取的手续费.
如:DaoPay和mEnable在[支付结算]时,要收取25%的手续费.
支持投资交易 在[投资交易]时,可否使用本[支付选项]用来[支付结算].
因为有些[支付选项]的[支付手续费]过高,如果太高了,我们得不到那么多[投资本金],这样对我们会造成很大的损失.
如:DaoPay和mEnable不能进行[投资交易] 枚举
未认证帐户最小支付额 客户填写[子支付记录]时, 填写[支付金额]的最小数值.
未认证帐户最大支付额 类推
已认证帐户最小支付额 类推
已认证帐户最大支付额 类推
以下字段是对[支付选项]对应的[子帐户]设置的
子帐户余额注资 本[子帐户]能否使用其对应的[支付选项]进行[子帐户注资]
如:DaoPay和mEnable不能对其DaoPay和mEnable[子帐户]进行[子帐户注资]操作.
做为取款的收款方式 客户提交[帐户取款申请表单]时,客户可否选择本[支付选项]做为[帐户取款申请]的收款方式.
例子:
CashU[子帐户余额]不能使用CashU[支付选项]做为取款的收款方式.
其他[子帐户],如STP[子帐户]也不能选择CashU做为取款的收款方式.
子帐户类型 各[子帐户]分为三个类类型：独立,在线和离线.
在线类型:该类型的[子帐户余额]可使用离线子帐户进行取款.
如:STP[子帐户余额]可以使用Bank Wire[支付选项]取款,也能使用STP[支付选项]取款.

离线类型:离线类型的子帐户只能使用离线子帐户进行取款.
如:Bank Wire[子帐户余额]可以使用Bank Wire[支付选项]取款,也能使用邮政汇款[支付选项]取款.

独立类型:该类型的子帐户余额只能使用自身进行取款.
如: AlertPay[子帐户余额]只能AlertPay[支付选项]取款,不能使用其他任何[支付选项]取款

但是各[支付选项]首先要实现[做为取款的收款方式]的属性.
提成结算方式 相关[支付表单]的[处理状态]更改为[正式生效]以后,上线获得提成是否立即打入到其对应的[子帐户]内.
手动 | 自动
生成eVourcher 其[子帐户余额]能否生成eVourcher进行流通
能 | 否
如:AlertPay[子帐户余额]不能生成eVourcher
取款手续费 各用户组的[取款申请]时所要支付的手续费
通常是一个常数加一个百分比.
如:5%+2.99$

详细查看<支付选项清单.xls>的[取款手续费工作表].

[子帐户]取款设置
未认证帐户最小取款额 客户填写[取款表单]时, 填写[取款金额]的最小数值.
已认证帐户最小取款额 类推
未认证帐户最大取款额 类推
已认证帐户最大取款额 类推
帐户升级提成 客户在[帐户升级]时,使用本[支付选项]或其对应[子帐户余额]进行[支付结算]后,其上线能够获得的提成比例.
上线根据其用户组不同,而提成也有所不同.
详细查看<支付选项清单.xls>的[投资交易提成工作表].

投资交易提成 客户在[投资交易]时,使用本[支付选项]或其对应[子帐户余额]进行[支付结算]后,其上线能够获得的提成比例.
上线根据其用户组不同,而提成也有所不同.
详细查看<支付选项清单.xls>的[帐户升级提成工作表].

支付时间描述 从客户[支付结算]完成开始,到我们收到其[支付款项]的整个过程需要花费多长时间.
取款时间描述 从客户选择本[支付选项]申请取款开始,到他们收到我们支付款项的整个过程需要花费多长时间.
取款延迟处理设置 各用户组延迟处理的时间设置,用户[帐户取款申请]时,选择[处理类型]选择的[延迟取款申请]以后,到了设定的时间以后提醒管理员付款给客户.

由于用户的取款手续费过高,为了让用户降低投资成本,所以用户在取款申请中选择正常处理或者延迟处理。
正常处理:根据存/取款的时间描述内进行处理,这种方式会根据存取款手续费清单扣取手续费.
延迟处理:这种方式取款手续费为0,但是客户要在1-2个月后才能获得付款.
标准帐户要在60天以后获得款项
白银帐户要在45天以后获得款项
黄金帐户要在30天以后获得款项
代理商帐户要在30天以后获得款项
合作伙伴帐户要在30天以后获得款项
客户选择这种方式以后,系统在没有到规定的时间不显示出来取款申请,到了规定的时间才显示出来,并且让管理员进行处理.管理员处理取款申请的时候可以筛选取款类型.

系统支持的[支付选项]的清单,以及各支付选项的[属性值]请查看<支付选项清单.xls>的[主要工作表].

每个[支付选项]在[支付结算]时还会需要[收款帐户号码],[验证密锁]等字段信息,这些信息最好是存放在脚本里,如果信息有所改动,管理员需要修改脚本里的变量信息.每个[支付选项]都一个[环境变量]脚本,该脚本存放[收款帐户]等重要信息
支付选项清单会列出所有[支付选项]对各属性的取值.

3.5.4. 支付结算流程
每笔[子支付记录]在[支付结算]时,根据其[结算方式]的分为三种流程.

[奖金帐户支付]处理流程:
1. 客户点击[操作栏]的[支付]按钮后,[支付结算]完成,本[子支付记录]的[支付]按钮消失.
2. [支付结算]完成,并进行[子支付记录处理]

[子帐户余额支付]处理流程:
3. 客户点击[操作栏]的[支付]按钮后,[支付结算]完成,本[子支付记录]的[支付]按钮消失.
4. [支付结算]完成,并进行[子支付记录处理]

例子:
客户A[理财帐户]的CashU[子帐户余额]剩余100$,他填写[支付表单]其中一栏的[子支付记录]选择的[结算方式]为[子帐户余额支付],[支付选项]选择的是CashU,[支付金额]填写的是99$.
客户点击本栏[子支付记录]的[支付]按钮后,CashU[子帐户余额]会扣除99$,其当前[子帐户余额]只剩1$.

[在线支付]处理流程:
1. 客户点击[操作栏]的[支付]按钮进入[支付处理页]
2. [支付处理页]的隐含参数[付款目的]为[支付结算],会自动跳转到本[子支付记录]的[支付选项]的[支付接口].
3. 客户在[支付接口]提交相关帐户信息进行付款.
4. 客户付款完成后,[支付接口]会秘密发送客户的付款数据到我们系统的[支付状态更新脚本].
5. 完成付款以后[支付接口]会自动将页面跳转到我们系统的[支付结果页].
6. [支付结算]完成,并进行[子支付记录处理]

注意:
1. 如果支付时,客户本[支付选项]没有对应的[支付帐户信息]也可以支付.取款时必须检测支付帐户信息.如果支付时,客户帐户存在[支付帐户信息],那么使用他的支付帐户信息进行支付.
2. 恶意攻击者可能会分析我们的[支付处理页]的跳转数据,然后他们自己将[支付处理页]的金额进行修改,制定一个[支付处理页]跳转到[支付接口],试图以支付最小0.01$的金额来对该[子支付记录]进行欺诈.
解决方案:
在客户完成[支付接口]付款以后,[支付接口]的[通知脚本]会将客户的[实际付款金额]和相关数据发送给我们,我们以此信息来更改客户[支付结算]的那笔[子支付记录]的信息.
如果客户试图以0.01$这样的金额来进行欺诈,他们支付完成后,[通知脚本]传送过来的[实际付款金额]累加到[子支付记录]的[已付金额],即[支付结算]前的[已付金额]加上当前[实际付款金额].如果[已付金额]不等于[结算金额],即[付款未完成],那么客户可以继续支付,这样不会引起不必要的纠纷.

[离线支付]处理流程:
1. 客户点击[操作栏]的[支付]按钮进入[支付处理页]
2. 本[支付处理页]不会进行任何跳转,本页会告诉客户如何将[结算资金]付款给[支付中介机构]完成[支付结算]后,当然我们就会在此页提供我们在[支付中介机构]的[收款信息],这样我们才能收到客户的付款.
3. [支付处理页]还包含一个[已经付款]按钮,客户将资金支付给[支付中介机构]后,客户可以点击该[按钮]提醒管理员进行处理,点击以后客户就不能再点击了.
4. 进入[支付结果页],该页告诉客户我们在收到付款后第一时间通知他.
5. [支付结算]完成,并进行[子支付记录处理].

3.5.5. 子支付记录处理
概述:[支付结算]完成后,我们可能会对该笔[子支付记录]的相关信息进行一些修改,根据[结算方式]进行分类处理.以下是各[结算方式]的[支付结算处理流程]:

[奖金帐户支付]的[支付结算处理流程]
[支付结算]完成后,系统会自动进行如下操作:
 更改[子支付记录]的[已付金额]
将[子支付记录]的[已付金额]改为[结算金额].
 更改[子支付记录]的[支付状态]
根据[子支付记录]的[支付状态][检测条件]修改其[支付状态].
 更新客户[理财帐户]的[奖金帐户余额]
系统自动提交一张[奖金帐户收支表单].

[子帐户余额支付]的[支付结算处理流程]
[支付结算]完成后,系统会自动进行如下操作:
 更改[子支付记录]的[已付金额]
将[子支付记录]的[已付金额]改为[结算金额].
 更改[子支付记录]的[支付状态]
根据[子支付记录]的[支付状态][检测条件]修改其[支付状态].
 更新客户[理财帐户]的[子帐户余额]
系统自动提交一张[子帐户余额收支表单],表单信息如下
理财帐户编号: [子支付记录][支付表单]的[主表单]系统自动填写的[理财帐户编号]
子帐户: [子支付记录]所选择的[支付选项]
收支方向: 支出
金额: [子支付记录]系统自动计算出来的[结算金额]
用途: [子支付记录][支付表单]的[主表单]的名称:
这里是”投资交易”
日期: 当前服务器的日期
备注: N/A

[在线支付]的[支付结算处理流程]
[支付结算]完成后,系统会自动进行如下操作:
 更改[子支付记录]的[已付金额]
支付后的[已付金额]等于支付前的[已付金额]加上本次[支付结算]客户[在线实际支付金额]
 更改[子支付记录]的[支付状态]
根据[子支付记录]的[支付状态][检测条件]修改其[支付状态].
 更新[支付表单]及其[主表单]的处理状态
如果本[支付表单]的所有[子支付记录]的[处理状态]均为[付款完成],那么将[支付表单]的[处理状态]修改为[付款完成],同时其[主表单]的[处理状态]也要修改为[付款完成]

[离线支付]的[支付结算处理流程]
[支付结算]完成后,我们的网站管理员会人工确认并进行如下操作:
 更改[子支付记录]的[已付金额]
将本[子支付记录]的[已付金额]更改为[离线实际支付金额].
 更改[子支付记录]的[支付状态]
根据[子支付记录]的[支付状态][检测条件]修改其[支付状态].
 更新[支付表单]及其[主表单]的处理状态
如果本[支付表单]的所有[子支付记录]的[处理状态]均为[付款完成],那么将[支付表单]的[处理状态]修改为[付款完成],同时其[主表单]的[处理状态]也要修改为[付款完成]

3.5.6. 支付处理页
3.5.7. 支付结果页
3.5.8. 支付状态通知脚本

3.6. 子帐户
3.6.1. 子帐户概述
每个[理财帐户]都包含多个子帐户,每种[支付选项]对应关联[理财帐户]的一个子帐户,[子帐户名称]就是[支付选项]的名称,每个子帐户都有[子帐户余额],每个[子帐户余额]负责对其对应的[支付选项]的所有交易进行结算.

同时为了能够减少客户在[投资交易]和[帐户升级]时,使用[在线支付]或[离线支付]的处理时间,客户可以预先进行[子帐户注资],然后使用[子帐户余额]进行其[支付结算],点击这里查看具体的[子帐户注资流程].

系统或我们的网站管理员在更改客户[理财帐户]某[子帐户余额]的之前,需要提交一张[子帐户收支表单],以便记录下客户[理财帐户][子帐户余额]的每笔资金的收入或支出信息,让客户了解其[子帐户余额]的流动情况.[子帐户收支表单]提交以后,系统会自动根据表单的信息更新客户[理财帐户]的[子帐户余额].
通常每笔表单包含如下信息:
 理财帐户编号
 子帐户
 收支方向
 收入金额|支出金额
 用途|来源
 日期
 备注

例子:
1. 我们系统支持客户使用AlertPay[支付选项]进行[支付结算],那么客户的[理财帐户]会有一个对应的AlertPay[子帐户].
3.6.2. 子帐户注资流程
客户对某[子帐户]进行[子帐户注资]操作,必须按照以下步骤进行:
1. 客户填写[注资表单]
2. [注资表单]填写完成以后,客户需要进行[注资结算],点击查看[注资结算流程]
3. [注资结算]完成以后,我们会进行[注资表单处理]

3.6.3. 注资结算流程
按照客户在[注资表单]选择的[注资帐户],对应的[支付选项]的[支付选项结算类型]进行分类:

[在线支付结算类型]的[支付选项][注资结算流程]
1. 客户点击[注资结算]按钮提交[注资表单]后,系统会进入[支付处理页]
2. [支付处理页]的隐含参数[付款目的]为[注资结算],会自动跳转到该[支付选项]的[支付接口].
3. 客户在[支付接口]提交相关帐户信息进行付款.
4. 客户付款完成后,[支付接口]会秘密发送客户的付款数据到我们系统的[支付状态更新脚本].
5. 完成付款以后[支付接口]会自动将页面跳转到我们系统的[支付结果页].
6. [注资结算]完成,并进行[注资表单处理]

[离线支付结算类型]的[支付选项][注资结算流程]
1. 客户点击[操作栏]的[支付]按钮进入[支付处理页]
2. 本[支付处理页]不会进行任何跳转,本页会告诉客户如何将[结算资金]付款给[支付中介机构]完成[支付结算]后,当然我们就会在此页提供我们在[支付中介机构]的[收款信息],这样我们才能收到客户的付款.
3. [支付处理页]还包含一个[已经付款]按钮,客户将资金支付给[支付中介机构]后,客户可以点击该[按钮]提醒管理员进行处理,点击以后客户就不能再点击了.
4. 进入[支付结果页],该页告诉客户我们在收到付款后第一时间通知他.
5. 我们收到客户的付款后,[注资结算]完成,并进行[注资表单处理].

3.6.4. 注资表单处理
按照客户在[注资表单]选择的[注资帐户],对应的[支付选项]的[支付选项结算类型]进行分类:

[在线支付结算类型]的[支付选项][注资表单处理],以下操作由系统自动进行:
1. 更新[注资表单]的[已付金额]
2. 更新[注资表单]的[处理状态]

[离线支付结算类型]的[支付选项][注资表单处理],以下操作由网站管理员人工进行:
1. 更新[注资表单]的[已付金额]
2. 更新[注资表单]的[处理状态]

4. 用户
 客户
客户在系统开设帐户以后可以通过使用本系统的投资理财服务获取投资收益,同时也可通过营销推广功能将我们网站推广给其他人,下线进行相关交易可从我们这里赚取到佣金.
 客户代表
客户代表主要负责帮助客户解决在使用本系统时所遇到的问题,客户可以对客户代表进行评分,我们每月会对客户代表的表现予以提成.
 合作伙伴
为了建立我们的销售网络,需要与一些网络媒体进行合作,这些网络媒体就是我们的合作伙伴.而我们通常的合作方式是这样的,他们给予我们较低的广告价格,我们为他们开设一个合作伙伴帐户,然后他们将合作伙伴帐户的推广连接发布到他们网站上为我们进行推广,他们的下线进行相关交易后从我们这里赚取佣金以实现双赢的目的.
 管理员
管理员负责处理日常的交易,帐户认证，存款，取款
5. 环境
6. 当前执行的任务和规程
附录I-数据表单
1. 理财帐户申请表单
概述:
[理财帐户申请表单]是客户对每位客户[理财帐户]的一个记录,客户可以随时修改[理财帐户]的以下信息:
 个人信息
[帐户认证]以后不能修改以下信息:
 姓名
 地址
 城市
 省市
 国家
 支付信息
 帐户信息

可用行为(方法):
 激活帐户
 帐户升级
 帐户认证
 个人信息修改
 支付信息修改
 帐户信息修改

表单示例:
1.个人信息 2.支付信息
基本信息 AlertPay帐户
姓名: 年龄: 帐户名称: 帐户号码:
性别: 已婚: LibertReserve帐户
联系信息 帐户名称: 帐户号码:
地址: 地址: STP帐户
城市: 省/市: 帐户名称: 帐户号码:
国家: 邮编: CashU帐户
电话: 手机: 帐户名称: 帐户号码:
EcoCard帐户
3.帐户信息 帐户名称: 帐户号码:
Email: Email确认: PerfectMoney帐户
帐户密码: 密码确认: 帐户名称: 帐户号码:
PIN码: PIN码确认: UseMyBank帐户
安全问题1 安全问题1: 帐户名称: 帐户号码:
是否愿意接受Newsletter: 是 或 否 是否接受服务条款: 是 或 否 Bank Wire信息
输入图灵验证码: 723898 帐户名称:
帐户号码:
开户银行: 分行名称:
分行地址: SWIFT/IBAN:
附加信息
来源URL 开户时间 激活状态 认证状态
帐户等级 高级帐户
过期时间
理财帐户上线信息
1级理财帐户
上线 2级理财帐户上线 3级理财帐户上线 4级理财帐户上线
5级理财帐户上线
代理商上线信息
1级代理商上线 2级代理商
上线 3级代理商
上线 4级代理商
上线
5级代理商上线
异常:
 表单过程全程使用ajax效果,如果必填信息没有填写那么会出现错误信息.
 注册时填写资料的过程中可以随时选择返回到上一步或者进入下一步;获得帐户号码以后就不能再返回了,只能进入下一步.
 如果当前步骤出现错误信息,那么无法进入下一步.
 验证码不正确无法进入下一步
 如果该用户的IP已经注册过帐户了,或者在登陆IP日志里查到该IP登陆过.那么提示用户不能再重复注册,请他联系客户代表.
 如果email地址已经注册过,那么客户无法成功开户.
现在我们只接受个人客户,不接受公司或机构组织客户.
2. 投资表单
概述:
[投资表单](又称[投资记录])的目的就是记录客户的每笔[投资交易]的相关信息,客户可以随时在[理财帐户][交易历史]里查询到每笔[投资记录].在填写[投资表单]时,我们会要求客户选择一种[投资方案].
待[投资表单][完成付款]后,我们会将本次[投资交易]的[投资本金]按照客户选择的[投资方案]投资外汇市场以获得不同的投资收益.
通常我们提供了多种[投资方案],每种[投资方案]拥有不同的风险和收益,客户可以根据自身的经济情况选择适合自己的[投资方案].

可用行为(方法):
客户[投资表单]填写完成以后,并且其[处理状态]为[等待付款],可以对其进行如下操作:
 取消表单

[投资表单]的[处理状态]修改为[付款完成]后,可以进行如下操作:
 申请立即生效
 投资交易退款(取消)
7天之内可以申请退款,7天以后就不能退款,并且[处理状态]修改为[正式生效].

[投资表单]的[处理状态]修改为[正式生效]后,可以进行如下操作:
 取回投资本金
 取回复投资金

表单示例:

表单字段描述(类属性):
字段名称 字段描述 取值备注
以下字段由客户填写
投资金额 [投资金额]也是[支付表单]的[应付总金额]. 两位浮点小数
投资方案编号 客户首先选择投资方案,然后这里填写[投资方案编号] 正整数
以下字段由系统填写
投资流水号 本表单的流水号,该号码是[投资表单]的唯一标示.
该信息要在客户正式提交表单后才生成 字符串
采用16位数字,前缀”AWI”.
建表日期 该表单生成的日期,日期格式如下:March-25-2009 14:25 日期
理财帐户编号 客户的[理财帐户]的编号,注意编号不是[理财帐户]的[数字帐户号码] 正整数
支付表单流水号 本表单的[附加表单][支付表单]的[流水号],每张[投资表单]都会与一张独一无二的[支付表单]相关联. 字符串
处理状态 该[投资表单]可能会处于以下状态:
 等待付款
客户表单已经填写完毕,但是还未支付[投资本金].
 未完成付款
客户已经支付[投资本金],但是未完全支付[投资本金]
 等待生效(又称”付款完成”)
从客户[建表日期]到当前日期的间隔,本表单还在[退款保证日]内,未正式生效,暂且不能获得投资收益.
本[投资表单]的[处理状态],会在其[支付表单]的[处理状态]修改为[付款完成]以后,才为修改为该状态,即[等待生效].
 正式生效
从客户[建表日期]到当前日期的间隔,本表单已经不在[退款保证日内],本表单就[正式生效],客户已经可以获得[投资收益].
 已取消
客户还未支付[投资本金]就将本表单取消了.
 退款处理中
本[投资表单][处理状态]还处于[等待生效]时申请了[投资交易退款],并且还在处理中.
 已成功退款
[投资交易退款]处理完毕
 已取回本金
本[投资表单][处理状态]处于[正式生效]后可以申请[取回本金], [取回本金]处理完毕以后更新为该状态. 枚举

客户填写投资表单后,会进行以下条件检测:
1) 当前是否接受客户投资,因为有时候我们会对系统进行维护,而停止接受客户的投资.
2) 客户的总投资金额是否已经超过100,000$的[投资限额],如果超过那么客户不能进行[投资交易].
3) [投资方案][首次最低投资额度] 检测
4) [投资方案][再次最低投资额度] 检测
5) [投资方案] [最大投资额度] 检测
6) [投资方案] [开放日期] 检测
7) [投资方案] [关闭日期] 检测

每次填写的[投资表单]即为独一无二的[投资记录],每笔[投资记录]可以获得多笔[投资收益],每笔投资[投资收益]作为独一无二的[投资收益记录],并且总是和一笔[投资记录]相关联.
3. 支付表单
概述:
[支付表单]会做为其他表单(如[投资表单])的[ 附加表单 ],其他表单(如[投资表单])做为[支付表单]的[主表单],它们彼此关联和依赖,[支付表单]做为客户[支付结算]的依据,[支付表单]的状态会影响[主表单]的状态.

通常客户将[支付表单]的[应付总金额]分为多次支付给我们,每次付款的信息我们称为[付款记录] (又称[子支付记录]),[支付表单]的作用就是记录客户在为其[主表单]进行[支付结算]时的[付款记录].
客户在[支付结算]时,我们提供了4种[结算方式],每种[结算方式]又提供了不同的[支付选项]供客户选择.
[支付表单]可以填写多栏,每栏填写每笔[子支付记录].

本[支付表单]的[处理状态]处于[付款完成]7天后,系统会自动将其 [处理状态]更新为[正式生效],同时系统会自动将其[主表单]的[处理状态]更新为[正式生效].

可用行为(方法):
本[支付表单]的每笔[子支付记录]填写完成后,各[子支付记录]进行以下操作:
 确认-[子支付记录确认]
当客户[子支付记录]填写完成后,客户要对该[子支付记录]填写的信息点击[操作栏]的[确认]按钮对信息进行确认,确认以后客户就不能改变该[子支付记录]所填写的信息,确认之前是可以改写的.
——————————————————————————————–
每次[子支付记录确认]以后,并且该[子支付记录]没有进行[支付结算],那么进行如下操作:
 支付结算
客户[子支付记录]的所填写的信息确认以后就可以点击[操作栏]的[支付]按钮对该栏[子支付记录]进行[支付结算],点击这里查看[支付结算流程].该笔[子支付记录]进行[支付结算]后,并且[已支付金额]等于[结算金额]后,那么该笔[子支付记录]的[处理状态]会修改为[付款完成],并且[支付]按钮消失.
 取消-[子支付记录取消]
如果客户还没有对本栏[子支付记录]进行[支付结算],并且觉得填写的信息不正确,那么客户可以[取消]该栏的[子支付记录]信息进行重新填写.
该笔[子支付记录]进行[支付结算]后,即[已支付金额]大于0,那么[取消]按钮消失,客户不能够再取消本[子支付记录],但是客户可以对其[主表单]进行[退款申请]操作.

表单示例:

支付流水号: AWP1234567890123456 表单处理状态: 等待付款
结算方式 支付选项 支付金额 支付费用 结算金额 已付金额 付款时间 备注 支付状态 操作
帐户余额支付 CashU
(查询帐户余额) 1.00$ 0.00$ 1.00$ 1.00 2009-05-07 15:34 N/A 等待付款|
付款未完成|
付款完成 付款|
确认|
取消|
在线支付 CashU 100.00$ 1.00$ 101.00$ 1.00 2009-05-07 15:34
等待付款|
付款未完成|
付款完成 付款|
确认|
取消|
离线支付 Bank Wire 100.00$ 0.00$ 100.00$ 1.00 2009-05-07 15:34 等待付款|
付款未完成|
付款完成 付款|
确认|
取消|
奖金帐户支付 AlertPay 100.00$ 0.00$ 100.00$ 1.00 2009-05-07 15:34 等待付款|
付款未完成|
付款完成 付款|
确认|
取消|
应付总金额: 300.00$
支付总金额: 201.00$
总费用: 1.00$
结算总金额: 202.00$
已付总金额: 0.00$
未付总金额: 202.00$
表单字段描述(类属性):
字段名称 字段描述 取值备注
以下字段由客户填写,以下字段组成为一栏,可以填写多栏.就像发票栏一样.
结算方式 [结算方式]分为以下4种方式:
 [奖金帐户支付]
客户选择使用[理财帐户]的[奖金帐户余额]进行[支付结算].
但是只有[投资表单]在[支付结算]才支持[奖金帐户支付],[帐户升级]时是不支持使用[奖金帐户支付]进行[支付结算]
 [帐户余额支付]
客户选择[理财帐户]的其中一个[子帐户],并且从[子帐户余额]内扣除[结算金额]相等的余额进行[支付结算].点击这里查看[子帐户]信息.
 [在线支付]
通过[在线支付结算类型]的[支付选项]进行[支付结算].
 [离线支付]
通过[离线支付结算类型]的[支付选项]进行[支付结算]. 枚举:

支付选项
(子帐户选项)
此值会根据每笔[子支付记录]所填写的[结算方式]的选择而有所不同,以下各[支付选项]在各[结算方式]的定义:
————————————————————————————————————————————-
 [奖金帐户支付]
客户需要选择一个本[子支付记录]在[投资收益结算]时,[投资收益]要打入的[子帐户].
系统会列出系统所有[子帐户]供客户选择.
 [帐户余额支付]
此时所选择的[支付选项]即是要求客户[理财帐户]的[子帐户].
系统会列出支持本[支付表单]的[主表单]对应行为的[子帐户]清单,客户必须选择从中选择一个[子帐户],被选中的[子帐户]的[子帐户余额]会在[支付结算]时,被扣取该笔[子支付记录]的[结算金额]等值的资金.
只列出[子帐户余额]大于0的[子帐户]
例子:
1. DaoPay和mEnable的[子帐户余额]不支持进行[投资交易],如果本[支付表单]的[主表单]为[投资表单],那么DaoPay和mEnable [子帐户]不会列出到这里.
2. 奖金[子帐户]的[子帐户余额]不支持[帐户升级],如果本[支付表单]的[主表单]为[帐户升级表单],那么奖金[子帐户]不会列出到这里.
————————————————————————————————————————————-
 [在线支付]
系统会列出支持本[支付表单]的[主表单]对应行为的[支付选项]清单,并且这些[支付选项]的[支付选项结算类型]为[在线支付].
例子:
1. [支付选项]DaoPay和mEnable不支持进行[投资交易],如果本[支付表单]的[主表单]为[投资表单],那么[支付选项]DaoPay和mEnable不会列出到这里.
————————————————————————————————————————————-
 [离线支付]
系统会列出支持本[支付表单]的[主表单]对应行为的[支付选项]清单,并且这些[支付选项]的[支付选项结算类型]为[离线支付].
例子:
1. 假如[支付选项]邮政汇款不支持进行[投资交易],如果本[支付表单]的[主表单]为[投资表单],那么[支付选项]邮政汇款不会列出到这里.
————————————————————————————————————————————-
针对本栏[子支付记录]的[结算金额]客户选择使用哪种[支付选项]支付给我们,点击[支付选项清单]查看我们目前支持的[支付选项]. 枚举
支付金额 客户本[子支付记录]预将[支付结算]的金额,但是在[支付结算]时,客户要支付的金额不是该金额,而是[结算金额].
每栏的以下字段由系统自动计算生成
费用 有的[支付选项]在[支付结算]时会收取[支付手续费].如DaoPay和mEnable都会收取25%.
结算金额 支付金额+费用=结算金额
已付金额 客户本次[支付结算]已经支付的金额,如DaoPay和mEnable一次可能不能[支付结算]完所有的[结算金额].
付款时间 客户本[子支付记录]最后一次[支付结算]的时间.
支付状态 要修改[子支付记录]的[支付状态]必须满足如下条件(即[检测条件]):
 等待付款
本[子支付记录] 的[已付金额]=0.
 付款未完成
未完全将本[子支付记录]的[结算金额][支付结算],本[子支付记录] 的[已付金额]>0.
 付款完成
已经[支付结算]完成本[子支付记录]的[结算金额],本[子支付记录] 的[已付金额]等于[结算金额].
操作  确认
 付款
 取消
以下汇总字段每笔[支付表单]只有一个,由系统自动计算生成
支付流水号 本表单的流水号,该号码的唯一标示.
该信息要在客户正式提交表单后才生成. 采用16位数字,前缀”AWP”.
应付总金额 主表单应该支付的总金额.结算总金额=应付总金额+总费用.
支付总金额 客户填写的付款总金额.
总费用
结算总金额 本[支付表单所有[子支付记录]的[结算金额]之和.
已付总金额 本[支付表单][子支付记录]的[处理状态]为[付款完成]的所有[子支付记录]的[结算金额]之和.
未付总金额 结算总金额-已付总金额=未付总金额
处理状态  已过期
 等待付款
 付款未完成
 付款完成
本[支付表单]的[处理状态]修改为[付款完成]必须满足以下几个条件:
1. 本[支付表单]的所有[子支付记录]的[处理状态]均为[付款完成]
2. 所有[子支付记录]的[支付金额]之总和等于本[支付表单]的[应付总金额].
[支付表单]的[处理状态]修改为[付款完成]后,系统会将其[主表单]的[处理状态]也修改为[付款完成],此后本[支付表单]不能再进行任何修改和操作.
客户[支付结算]完成后,系统会记录以下信息,但是客户看不到以下信息,通常以下信息由[支付接口]自动发送给系统.
付款帐号
支付流水号
付款所在国
异常:
1. 最小和最大支付金额的检测
2. 客户在填写[子支付记录]时,如果客户[结算方式]选择的是[子帐户余额支付],如果其[支付选项]的[子帐户余额]小于本[子支付记录]的[结算金额],那么客户点击[操作栏][确认]按钮时会提示客户余额不足,并且要求重新填写[支付金额].
3. 在填写[子支付记录]信息时,如果本[支付表单]的所有[子支付记录]的[支付金额]总和已经大于或等于本[支付表单]的[应付总金额],那么客户在点击[操作栏]的[确认]按钮时会提示”支付金额填写错误,需要重新填写”,并且会自动将本[子支付记录]的[支付金额]更改为[未付总金额].
4. 客户的某些[子支付记录]的[实际支付金额]可能小于或大于[子支付记录]的[结算金额]
5. 如果10天内本[支付表单][处理状态]还未修改为[付款完成]
解决方案:[支付表单]的[主表单]状态自动改为已取消,管理员不会再进行处理.
6. 如果10天以后公司才收到各[子支付记录]的款项(只有[离线支付]类型的[支付选项]在[支付结算]时才会出现这种情况)
解决方案:,并按照正常程序处理.
7. 通过发票栏的直接选择好像用户体验不够好,不能很好的引导客户,建议使用添加[子支付记录]的形式进行,然后每笔[子支付记录]添加时立即进行付款.
注意事项:
1. 每张[投资表单]的[支付表单]只能添加一条[结算方式]为[奖金帐户支付]的[子支付记录].
2. DaoPay和mEnable的[支付结算]不能进行退款,客户选择这两种支付选项时一定要提醒他们.
3. 每栏的[子帐户余额支付]对应的[支付选项]只能填写一次.
如:第一栏为[帐户余额支付],[支付选项]为CashU,那么以后填写的每栏[子支付记录]时,选择[帐户余额支付]时, [支付选项]就不能再填写CashU了,避免造成重复扣款和逻辑的增加;
如果CashU的[支付选项结算类型]为[离线支付],那么客户可以在以后其中一栏可以填写[离线支付],[支付选项]为CashU,这样的意思为当[子帐户余额]不足是,可以立即使用其对应的[支付选项]立即进行结算;

当然,如果CashU的[支付选项结算类型]为[在线支付],那么客户可以在以后其中一栏可以填写[在线支付],[支付选项]为CashU;

因此客户即可以使用某[子帐户]的[子帐户余额支付],也可以使用该[子帐户]相关联的[支付选项]进行[即时支付].
4. 如果[子支付记录]的[已付款金额]已经大于0,那么客户就不能再删除该[子支付记录],即[操作]栏的[删除]按钮不存在了,客户只能点击[支付]按钮.这样会造成数据错误
5. [支付结算] 完成后本[子支付记录]的[操作栏]的所有[按钮]都消失.
6. 客户可随时进入本[支付表单]查看其[子支付记录]的[处理状态]和[已付款金额].

每笔[子支付记录]实际上可以和其[支付表单]的[主表单]看做一条独立和完整的记录.
如:[投资表单]的[投资金额]为100$,[投资表单]的处理状态为[正式生效],其[支付表单]有一条[子支付记录]A的[支付金额]为12$,[支付选项]为AlertPay.
A也可以看做一笔独立的[投资表单],该[投资表单]的[投资金额]为12$,…

4. 注资表单
概述:
[注资表单](又称[注资记录])的作用就是记录客户每次对[子帐户余额注资]时的相关信息.
点击查看[子帐户注资流程]

客户填写完[注资表单]后点击[注资结算]按钮进行提交保存,并且客户此时进行[注资结算].
点击这里查看[注资结算流程]
本[注资表单]的[处理状态]处于[付款完成]7天后,系统会自动将其 [处理状态]更新为[正式生效],同时系统会自动提交一张[子帐户收支表单]以更新[子帐户余额].

可用行为:
本[注资表单]的[处理状态]处于[等待付款]时,客户可以对其进行如下操作:
 注资结算
 取消注资

在本[注资表单]的[处理状态]处于[正式生效]前,客户可以对其进行如下操作:
 申请注资退款
 申请注资立即生效
客户进行该操作后,帐户[注资表单]的[处理状态]会立即更新为[正式生效],并且会提交一张[子帐户收支表单]以更新其[子帐户余额].

表单示例:
注资流水号: AWF1234567890123456
理财帐户号码: 123456
注资帐户: AlertPay
注资金额: 100.00$
实际支付金额: 100.00$
注资日期: 2009-05-09 10:12
处理状态: 等待付款|付款完成,等待生效|正式生效
表单字段描述:
字段名称 字段描述 取值备注
以下字段由客户填写
注资帐户 系统会列[支付选项]的[子帐户注资]属性值为[是]的所有对应的子帐户,并且供客户选择预将注资的[子帐户].
如:DaoPay和mEnable[子帐户]不会列出到这里供客户选择,因为它们的[支付选项] [支付选项]的[子帐户注资]属性值为[否]. 引用
注资金额 客户预将对该子帐户注资的金额. 两位浮点小数
以下字段由系统填写
注资流水号 字符串
采用16位数字,前缀”AWF”.
理财帐户编号 客户的[理财帐户]的编号,注意编号不是[理财帐户]的[数字帐户号码] 两位浮点小数
实际支付金额 客户在[注资结算]时实际支付的金额,如Bank Wire客户可能会少支付给我们,也可能多. 两位浮点小数
注资时间 该表单生成的日期,日期格式如下:March-25-2009 14:25 日期
处理状态  已取消
 等待付款
 付款完成
 正式生效 枚举

异常:
1. 我们收到的款项可能小于或大于[注资金额]
解决方案:通知客户收到的金额不一致,按照[实际支付金额]对[子帐户]进行注资
2. 如果10天内还没收到款项
解决方案:该笔[注资表单]的[处理状态]修改为[已取消],管理员不会再进行处理.
3. 如果10天以后公司才收到款
解决方案:我们发送邮件通知客户,并按照正常程序处理.

注意:
1. DaoPay和mEnable[支付选项]不能进行注资

5. 子帐户收支表单
6. 帐户升级表单
需要填写以下信息:
 理财帐户编号
 升级等级
 升级时间
 付款金额
 升级折扣
 结算金额
 建单日期
 处理状态
未付款|付款完成|已取消|正式生效.