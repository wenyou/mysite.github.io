---
layout: post
title: 验证码显示不出来–多半由于图片前有输出造成的
description: "验证码显示不出来–多半由于图片前有输出造成的"
category: php
tags: [验证码]
---

###验证码显示不出来–多半由于图片前有输出造成的###

验证码显示不出来，多半由于图片前有输出造成的。有一种根绝的办法，就是在验证码图片输出前加“ob_clean();”，在应用程序入口文件开头加上“ob_start();”。

例如：

	checkcode.php显示验证码图片文件的代码如下：
	require dirname(__FILE__).’/includes/common.inc.php’;
	//这里省略N多生成图片的代码。。。。
	//这里省略N多生成图片的代码。。。。
	//output to browser
	ob_clean();
	header(“content-type:image/png\r\n”);
	imagepng($im);
	imagedestroy($im);

再在common.inc.php文件的开头（或入口文件的开头）加上“ob_start();”。
common.inc.php代码如下：

	ob_start();
	
	define(‘IN_SCF’, TRUE);
	error_reporting(E_ALL);//E_ALL
	define(‘DS’,DIRECTORY_SEPARATOR);
	define(‘S_ROOT’, substr(__FILE__,0,-24).DS);
	$_CONFIG = $_SGLOBAL =array();
	$_CONFIG = parse_ini_file(S_ROOT.’config.ini’);
	date_default_timezone_set($_CONFIG['timezone_set']);
	$_start = explode(” “, microtime());
	$_SGLOBAL['timestamp'] =$timestamp = $_start[1];
	$_SGLOBAL['app_starttime'] = $_SGLOBAL['timestamp'] + $_start[0];
	set_include_path(S_ROOT.’includes’.DS);
	require_once ‘global.func.php’;
	ini_set(“magic_quotes_runtime”,0);
	define(‘DATA_PATH’,S_ROOT.’data’.DS);
	define(‘MAGIC_QUOTES_GPC’, get_magic_quotes_gpc());
	!defined(‘CURSCRIPT’) && define(‘CURSCRIPT’, ”);
	….
	….

这样处理后，验证码就会正常显示了。